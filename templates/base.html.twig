{# templates/base.html.twig #}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Interned{% endblock %}</title>
    <link rel="stylesheet" href="{{ asset('css/styles.css') }}">
    <script src="{{ asset('js/search.js') }}"></script>
    {% block stylesheets %}{% endblock %}
</head>
<body>
<header>
    <div class="logo">
        <img src="{{ asset('images/logo.png') }}" alt="Interned Logo">
        <span class="logo-text">Interned</span>
    </div>
    <nav>
        <ul>
            <li><a href="{{ path('app_home') }}" class="{{ app.request.get('_route') == 'app_home' ? 'active' : '' }}">Accueil</a></li>
            <li><a href="{{ path('app_annonces') }}" class="{{ app.request.get('_route') == 'app_annonces' ? 'active' : '' }}">Annonces</a></li>
            <li><a href="{{ path('app_wishlist') }}" class="{{ app.request.get('_route') == 'app_wishlist' ? 'active' : '' }}">Wishlist</a></li>
            <li><a href="{{ path('app_candidatures') }}" class="{{ app.request.get('_route') == 'app_candidatures' ? 'active' : '' }}">Candidatures</a></li>
        </ul>
    </nav>
    <div class="user-profile">
        <div class="profile-container">
            {% if app.user.profileImg %}
                <img src="{{ path('app_profile_image', {'id': app.user.id}) }}" alt="Profil" id="profileIcon">
            {% else %}
                <i class="fa fa-user profile-user-icon" aria-hidden="true" alt="Profil" id="profileIcon"></i>
            {% endif %}
            <div class="account-overlay" id="accountOverlay">
                <div class="user-info">
                    {% if app.user.profileImg %}
                        <img src="{{ path('app_profile_image', {'id': app.user.id}) }}" alt="Avatar" class="user-avatar">
                    {% else %}
                        <i class="fa fa-user profile-user-icon" aria-hidden="true" alt="Avatar" class="user-avatar"></i>
                    {% endif %}
                    <div class="user-details">
                        {% if app.user %}
                            {% if is_granted('ROLE_ADMIN') %}
                                <div class="user-name">{{ app.user.nomAdmin }} {{ app.user.prenomAdmin }}</div>
                            {% elseif is_granted('ROLE_PILOTE') %}
                                <div class="user-name">{{ app.user.nomPilote }} {{ app.user.prenomPilote }}</div>
                            {% elseif is_granted('ROLE_ETUDIANT') %}
                                <div class="user-name">{{ app.user.nomEtudiant }} {{ app.user.prenomEtudiant }}</div>
                            {% endif %}
                            <div class="user-email">{{ app.user.email }}</div>
                        {% else %}
                            <div class="user-name">Non connecté</div>
                            <div class="user-email">Veuillez vous connecter</div>
                        {% endif %}
                    </div>
                </div>
                <div class="overlay-links">
                    <a href="{{ path('app_profile') }}" class="overlay-button">Profil</a>
                    <a href="{{ path('app_dashboard') }}" class="overlay-link">Tableau de bord</a>
                    <a href="#" class="overlay-link">Préférences</a>
                    <a href="{{ path('app_logout') }}" class="overlay-button disconnect">Se déconnecter</a>
                </div>
            </div>
        </div>
    </div>
</header>

<main>
    {% block body %}{% endblock %}
</main>

<footer>
    <div class="footer-columns">
        <div class="column">
            <h3>Use cases</h3>
            <ul>
                <li>UI design</li>
                <li>UX design</li>
                <li>Wireframing</li>
                <li>Diagramming</li>
                <li>Brainstorming</li>
                <li>Online whiteboard</li>
                <li>Team collaboration</li>
            </ul>
        </div>
        <div class="column">
            <h3>Explore</h3>
            <ul>
                <li>Design</li>
                <li>Prototyping</li>
                <li>Development features</li>
                <li>Design systems</li>
                <li>Collaboration features</li>
                <li>Design process</li>
                <li>FigJam</li>
            </ul>
        </div>
        <div class="column">
            <h3>Resources</h3>
            <ul>
                <li>Blog</li>
                <li>Best practices</li>
                <li>Colors</li>
                <li>Color wheel</li>
                <li>Support</li>
                <li>Developers</li>
                <li>Resource library</li>
            </ul>
        </div>
    </div>
</footer>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const profileIcon = document.getElementById('profileIcon');
        const accountOverlay = document.getElementById('accountOverlay');
        
        if (profileIcon && accountOverlay) {
            // Afficher/cacher le menu au clic sur l'icône
            profileIcon.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                accountOverlay.classList.toggle('active');
            });
            
            // Fermer le menu si on clique ailleurs sur la page
            document.addEventListener('click', function(e) {
                if (!profileIcon.contains(e.target) && !accountOverlay.contains(e.target)) {
                    accountOverlay.classList.remove('active');
                }
            });
        }
    });
</script>
{% block javascripts %}{% endblock %}
</body>
</html>
